# 业务经验

## 幂等性设计

### 防重表

对字段设置唯一索引，插入时候可以检查出来

### 乐观锁

消息体中传入版本戳，更新的时候进行校验。再审核场景有用到

### 有限状态机

本质也是乐观锁，只是将版本戳改为状态机

### token + 分布式锁

客户端向服务端请求token

服务端生成存redis并返回给客户端

客户端带着token来请求

服务端校验通过先删redis 再做具体操作